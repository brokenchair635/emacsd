FROM ubuntu:latest

RUN apt-get update && apt-get install -y \
    build-essential \
    libsdl1.2-dev \
    libncurses5-dev \
    git \
    autoconf \
    texinfo \
    libgnutls28-dev \
    libcairo2-dev \
    libacl1-dev \
    libattr1-dev \
    libharfbuzz-dev \
    libjansson4 \
    libjansson-dev \
    && rm -rf /var/lib/apt/lists/*

RUN git clone https://github.com/torvalds/uemacs.git && \
    cd uemacs && \
    make && \
    mv em /usr/local/bin && \
    cd .. && \
    rm -rf uemacs

RUN git clone https://github.com/emacs-mirror/emacs.git && \
    cd emacs && \
    ./autogen.sh && \
    ./configure --with-x-toolkit=no --without-ns --without-xpm --without-jpeg --without-tiff --without-gif --without-png --without-rsvg --without-webp --without-pop --without-xft --without-xaw3d --without-gsettings --without-native-image-api --with-json --without-native-compilation && \
    make && \
    make install

RUN rm -rf /emacs

COPY init.el /root/.emacs.d/

CMD ["/bin/bash"]
